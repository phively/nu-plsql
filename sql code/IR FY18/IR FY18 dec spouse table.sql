Drop Table tbl_IR_FY18_dec_spouse
;

Create Table tbl_IR_FY18_dec_spouse (
  -- entity.id_number of entity on the report
  id_number varchar2(10)
  -- entity.id_number of former spouse to manually household
  , id_join varchar2(10)
)
;

Insert All
  Into tbl_IR_FY18_dec_spouse Values('0000072318', '0000072317')
  Into tbl_IR_FY18_dec_spouse Values('0000206429', '0000192640')
  Into tbl_IR_FY18_dec_spouse Values('0000370388', '0000155433')
  Into tbl_IR_FY18_dec_spouse Values('0000077223', '0000197708')
  Into tbl_IR_FY18_dec_spouse Values('0000019360', '0000196426')
  Into tbl_IR_FY18_dec_spouse Values('0000174461', '0000197707')
  Into tbl_IR_FY18_dec_spouse Values('0000287703', '0000525081')
  Into tbl_IR_FY18_dec_spouse Values('0000145883', '0000182956')
  Into tbl_IR_FY18_dec_spouse Values('0000550751', '0000302569')
  Into tbl_IR_FY18_dec_spouse Values('0000323211', '0000641379')
  Into tbl_IR_FY18_dec_spouse Values('0000155862', '0000285798')
  Into tbl_IR_FY18_dec_spouse Values('0000188467', '0000238610')
  Into tbl_IR_FY18_dec_spouse Values('0000573171', '0000205372')
  Into tbl_IR_FY18_dec_spouse Values('0000368994', '0000072068')
  Into tbl_IR_FY18_dec_spouse Values('0000047220', '0000630978')
  Into tbl_IR_FY18_dec_spouse Values('0000153283', '0000064744')
  Into tbl_IR_FY18_dec_spouse Values('0000066693', '0000158197')
  Into tbl_IR_FY18_dec_spouse Values('0000535420', '0000056617')
  Into tbl_IR_FY18_dec_spouse Values('0000159626', '0000316388')
  Into tbl_IR_FY18_dec_spouse Values('0000255929', '0000197689')
  Into tbl_IR_FY18_dec_spouse Values('0000359104', '0000643708')
  Into tbl_IR_FY18_dec_spouse Values('0000304177', '0000191126')
  Into tbl_IR_FY18_dec_spouse Values('0000066502', '0000066501')
  Into tbl_IR_FY18_dec_spouse Values('0000053658', '0000385040')
  Into tbl_IR_FY18_dec_spouse Values('0000630978', '0000047220')
  Into tbl_IR_FY18_dec_spouse Values('0000147634', '0000063484')
  Into tbl_IR_FY18_dec_spouse Values('0000715337', '0000327730')
  Into tbl_IR_FY18_dec_spouse Values('0000315592', '0000314207')
  Into tbl_IR_FY18_dec_spouse Values('0000099661', '0000168795')
  Into tbl_IR_FY18_dec_spouse Values('0000560654', '0000105879')
  Into tbl_IR_FY18_dec_spouse Values('0000515468', '0000387764')
  Into tbl_IR_FY18_dec_spouse Values('0000490678', '0000314234')
  Into tbl_IR_FY18_dec_spouse Values('0000410497', '0000303313')
  Into tbl_IR_FY18_dec_spouse Values('0000016338', '0000016339')
  Into tbl_IR_FY18_dec_spouse Values('0000153587', '0000159837')
  Into tbl_IR_FY18_dec_spouse Values('0000361370', '0000375262')
  Into tbl_IR_FY18_dec_spouse Values('0000138864', '0000342309')
  Into tbl_IR_FY18_dec_spouse Values('0000071883', '0000343588')
  Into tbl_IR_FY18_dec_spouse Values('0000326793', '0000524159')
  Into tbl_IR_FY18_dec_spouse Values('0000440463', '0000106843')
  Into tbl_IR_FY18_dec_spouse Values('0000173036', '0000072142')
  Into tbl_IR_FY18_dec_spouse Values('0000020521', '0000190061')
  Into tbl_IR_FY18_dec_spouse Values('0000170633', '0000318182')
  Into tbl_IR_FY18_dec_spouse Values('0000063419', '0000192870')
  Into tbl_IR_FY18_dec_spouse Values('0000483915', '0000626734')
  Into tbl_IR_FY18_dec_spouse Values('0000401734', '0000477835')
  Into tbl_IR_FY18_dec_spouse Values('0000366578', '0000016413')
  Into tbl_IR_FY18_dec_spouse Values('0000396867', '0000156807')
  Into tbl_IR_FY18_dec_spouse Values('0000071822', '0000071821')
  Into tbl_IR_FY18_dec_spouse Values('0000016725', '0000398262')
  Into tbl_IR_FY18_dec_spouse Values('0000131901', '0000350244')
  Into tbl_IR_FY18_dec_spouse Values('0000025815', '0000025816')
  Into tbl_IR_FY18_dec_spouse Values('0000527136', '0000072051')
  Into tbl_IR_FY18_dec_spouse Values('0000063938', '0000189207')
  Into tbl_IR_FY18_dec_spouse Values('0000403284', '0000575516')
  Into tbl_IR_FY18_dec_spouse Values('0000074189', '0000074190')
  Into tbl_IR_FY18_dec_spouse Values('0000398803', '0000534238')
  Into tbl_IR_FY18_dec_spouse Values('0000684515', '0000286825')
  Into tbl_IR_FY18_dec_spouse Values('0000156792', '0000072539')
  Into tbl_IR_FY18_dec_spouse Values('0000345238', '0000354009')
  Into tbl_IR_FY18_dec_spouse Values('0000109874', '0000661672')
  Into tbl_IR_FY18_dec_spouse Values('0000064744', '0000153283')
  Into tbl_IR_FY18_dec_spouse Values('0000072317', '0000072318')
  Into tbl_IR_FY18_dec_spouse Values('0000192640', '0000206429')
  Into tbl_IR_FY18_dec_spouse Values('0000088145', '0000173253')
  Into tbl_IR_FY18_dec_spouse Values('0000155433', '0000370388')
  Into tbl_IR_FY18_dec_spouse Values('0000196426', '0000019360')
  Into tbl_IR_FY18_dec_spouse Values('0000197707', '0000174461')
  Into tbl_IR_FY18_dec_spouse Values('0000238610', '0000188467')
  Into tbl_IR_FY18_dec_spouse Values('0000525081', '0000287703')
  Into tbl_IR_FY18_dec_spouse Values('0000205372', '0000573171')
  Into tbl_IR_FY18_dec_spouse Values('0000285798', '0000155862')
  Into tbl_IR_FY18_dec_spouse Values('0000072068', '0000368994')
  Into tbl_IR_FY18_dec_spouse Values('0000056617', '0000535420')
  Into tbl_IR_FY18_dec_spouse Values('0000387764', '0000515468')
  Into tbl_IR_FY18_dec_spouse Values('0000197689', '0000255929')
  Into tbl_IR_FY18_dec_spouse Values('0000191126', '0000304177')
  Into tbl_IR_FY18_dec_spouse Values('0000385040', '0000053658')
  Into tbl_IR_FY18_dec_spouse Values('0000158197', '0000066693')
  Into tbl_IR_FY18_dec_spouse Values('0000063484', '0000147634')
  Into tbl_IR_FY18_dec_spouse Values('0000168795', '0000099661')
  Into tbl_IR_FY18_dec_spouse Values('0000105879', '0000560654')
  Into tbl_IR_FY18_dec_spouse Values('0000316388', '0000159626')
  Into tbl_IR_FY18_dec_spouse Values('0000314234', '0000490678')
  Into tbl_IR_FY18_dec_spouse Values('0000016339', '0000016338')
  Into tbl_IR_FY18_dec_spouse Values('0000375262', '0000361370')
  Into tbl_IR_FY18_dec_spouse Values('0000342309', '0000138864')
  Into tbl_IR_FY18_dec_spouse Values('0000343588', '0000071883')
  Into tbl_IR_FY18_dec_spouse Values('0000302569', '0000550751')
  Into tbl_IR_FY18_dec_spouse Values('0000066501', '0000066502')
  Into tbl_IR_FY18_dec_spouse Values('0000106843', '0000440463')
  Into tbl_IR_FY18_dec_spouse Values('0000072142', '0000173036')
  Into tbl_IR_FY18_dec_spouse Values('0000318182', '0000170633')
  Into tbl_IR_FY18_dec_spouse Values('0000314207', '0000315592')
  Into tbl_IR_FY18_dec_spouse Values('0000303313', '0000410497')
  Into tbl_IR_FY18_dec_spouse Values('0000156807', '0000396867')
  Into tbl_IR_FY18_dec_spouse Values('0000643708', '0000359104')
  Into tbl_IR_FY18_dec_spouse Values('0000071821', '0000071822')
  Into tbl_IR_FY18_dec_spouse Values('0000398262', '0000016725')
  Into tbl_IR_FY18_dec_spouse Values('0000350244', '0000131901')
  Into tbl_IR_FY18_dec_spouse Values('0000025816', '0000025815')
  Into tbl_IR_FY18_dec_spouse Values('0000340987', '0000559154')
  Into tbl_IR_FY18_dec_spouse Values('0000390447', '0000590124')
  Into tbl_IR_FY18_dec_spouse Values('0000072051', '0000527136')
  Into tbl_IR_FY18_dec_spouse Values('0000354009', '0000345238')
  Into tbl_IR_FY18_dec_spouse Values('0000477835', '0000401734')
  Into tbl_IR_FY18_dec_spouse Values('0000286825', '0000684515')
  Into tbl_IR_FY18_dec_spouse Values('0000016413', '0000366578')
  Into tbl_IR_FY18_dec_spouse Values('0000072539', '0000156792')
  Into tbl_IR_FY18_dec_spouse Values('0000100582', '0000590070')
  Into tbl_IR_FY18_dec_spouse Values('0000047555', '0000644207')
  Into tbl_IR_FY18_dec_spouse Values('0000576809', '0000301878')
  Into tbl_IR_FY18_dec_spouse Values('0000394437', '0000190472')
  Into tbl_IR_FY18_dec_spouse Values('0000190472', '0000394437')
  Into tbl_IR_FY18_dec_spouse Values('0000049909', '0000422583')
  Into tbl_IR_FY18_dec_spouse Values('0000422583', '0000049909')
  Into tbl_IR_FY18_dec_spouse Values('0000541580', '0000103232')
  Into tbl_IR_FY18_dec_spouse Values('0000103232', '0000541580')
  Into tbl_IR_FY18_dec_spouse Values('0000017732', '0000017733')
  Into tbl_IR_FY18_dec_spouse Values('0000017733', '0000017732')
  Into tbl_IR_FY18_dec_spouse Values('0000197708', '0000077223')
  Into tbl_IR_FY18_dec_spouse Values('0000182956', '0000145883')
  Into tbl_IR_FY18_dec_spouse Values('0000641379', '0000323211')
  Into tbl_IR_FY18_dec_spouse Values('0000327730', '0000715337')
  Into tbl_IR_FY18_dec_spouse Values('0000159837', '0000153587')
  Into tbl_IR_FY18_dec_spouse Values('0000524159', '0000326793')
  Into tbl_IR_FY18_dec_spouse Values('0000190061', '0000020521')
  Into tbl_IR_FY18_dec_spouse Values('0000192870', '0000063419')
  Into tbl_IR_FY18_dec_spouse Values('0000626734', '0000483915')
  Into tbl_IR_FY18_dec_spouse Values('0000189207', '0000063938')
  Into tbl_IR_FY18_dec_spouse Values('0000575516', '0000403284')
  Into tbl_IR_FY18_dec_spouse Values('0000074190', '0000074189')
  Into tbl_IR_FY18_dec_spouse Values('0000534238', '0000398803')
  Into tbl_IR_FY18_dec_spouse Values('0000173253', '0000088145')
  Into tbl_IR_FY18_dec_spouse Values('0000559154', '0000340987')
  Into tbl_IR_FY18_dec_spouse Values('0000590124', '0000390447')
  Into tbl_IR_FY18_dec_spouse Values('0000590070', '0000100582')
  Into tbl_IR_FY18_dec_spouse Values('0000644207', '0000047555')
  Into tbl_IR_FY18_dec_spouse Values('0000301878', '0000576809')
  Into tbl_IR_FY18_dec_spouse Values('0000661672', '0000109874')
  Into tbl_IR_FY18_dec_spouse Values('0000311640', '0000539343')
  Into tbl_IR_FY18_dec_spouse Values('0000539343', '0000311640')
  Into tbl_IR_FY18_dec_spouse Values('0000288015', '0000541283')
  Into tbl_IR_FY18_dec_spouse Values('0000541283', '0000288015')
  Into tbl_IR_FY18_dec_spouse Values('0000303939', '0000541224')
  Into tbl_IR_FY18_dec_spouse Values('0000541224', '0000303939')
  Into tbl_IR_FY18_dec_spouse Values('0000350532', '0000545302')
  Into tbl_IR_FY18_dec_spouse Values('0000545302', '0000350532')
  Into tbl_IR_FY18_dec_spouse Values('0000063010', '0000499550')
  Into tbl_IR_FY18_dec_spouse Values('0000499550', '0000063010')
  Into tbl_IR_FY18_dec_spouse Values('0000369534', '0000545243')
  Into tbl_IR_FY18_dec_spouse Values('0000545243', '0000369534')
  Into tbl_IR_FY18_dec_spouse Values('0000408157', '0000510510')
  Into tbl_IR_FY18_dec_spouse Values('0000510510', '0000408157')
  Into tbl_IR_FY18_dec_spouse Values('0000784260', '0000382467')
  Into tbl_IR_FY18_dec_spouse Values('0000382467', '0000784260')
  Into tbl_IR_FY18_dec_spouse Values('0000088294', '0000158911')
  Into tbl_IR_FY18_dec_spouse Values('0000158911', '0000088294')
-- Commit table
Select * From DUAL
;
Commit Work
;

-- Check results
Select
  ds.id_number
  , entity.report_name
  , entity.record_status_code
  , ds.id_join
  , spouse.report_name As spouse_name
  , spouse.record_status_code As spouse_record_status
  , entity.jnt_gifts_ind
  , entity.spouse_id_number As curr_spouse_id
  , spouse.spouse_id_number As spouse_curr_spouse_id
  , Case
      When trim(entity.spouse_id_number) Is Not Null
        Or trim(spouse.spouse_id_number) Is Not Null
        Then 'Y'
      End
    As check_by_hand
From tbl_IR_FY18_dec_spouse ds
Inner Join entity
  On ds.id_number = entity.id_number
Inner Join entity spouse
  On ds.id_join = spouse.id_number
;
